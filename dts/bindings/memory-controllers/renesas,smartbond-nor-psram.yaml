# Copyright (c) 2023 Renesas Electronics Corporation
# SPDX-License-Identifier: Apache-2.0

description: Renesas Smartbond(tm) NOR/PSRAM controller

include: base.yaml

compatible: "renesas,smartbond-nor-psram"

properties:
  reg:
    required: true

  is-ram:
    type: boolean
    description: |
      If present, the memory controller will be configured to drive PSRAM devices.

  dev-size:
    type: int
    required: true
    description: |
      Memory size/capacity in bits.

  dev-type:
    type: int
    default: 0x5D
    description: |
      Device type, part of device ID, used for verification during MEMC initialization.

  dev-density:
    type: int
    default: 0xE040
    description: |
      Device density, part of device ID, used for verification during MEMC initialization.
      [7:0] should reflect the density value ifself and [15:8] should reflect the mask
      that should be applied to the returned device ID value. This is because part of its byte
      value might contain invalid bits.

  dev-id:
    type: int
    default: 0x0D
    description: |
      Manafacturer ID, part of device ID, used for verification during MEMC initialization.

  reset-delay-us:
    type: int
    default: 50
    description: |
      Time in microsends (us) the memory device can accept the next command following a SW reset.

  read-cs-idle-min-ns:
    type: int
    default: 18
    description: |
      Min. time, in nanoseconds, the #CS line should remain inactive between
      the transmission of two different instructions.

  erase-cs-idle-min-ns:
    type: int
    default: 0
    description: |
      Min. time, in nanoseconds, the #CS line should remain inactive after the execution
      of a write enable, erase, erase suspend or erase resume instruction. This setting
      is not used if is-ram property is present.

  enter-qpi-cmd:
    type: int
    default: 0x35
    description: |
      Command to enter the QPI mode supported by a memory device
      (should be transmitted in single bus mode).

  exit-qpi-cmd:
    type: int
    default: 0xF5
    description: |
      Commnad to exit the QPI mode supported by a memory device
      (should be transmitted in quad bus mode).

  enter-qpi-mode:
    type: boolean
    description: |
      If present, the memory device will enter the QPI mode which typically reflects that
      all bytes be sent in qaud bus mode. It's a pre-requisite that read and write
      commands, that should be read-cmd and write-cmd respectively, reflect the QPI mode.

  read-cmd:
    type: int
    default: 0xEB
    description: |
      Read command for single/burst read accesses in auto mode.

  write-cmd:
    type: int
    default: 0x38
    description: |
      Write command for single/burst write accesses in auto mode.

  clock-mode:
    type: int
    enum:
      - 0 # Mode0
      - 1 # Mode3
    default: 0
    description: |
      Clock mode when #CS is idle/inactive

      - Mode0: #CLK is low when #CS is inactive (#CS is active low)
      - Mode3: #CLK is high when #CS is inactive (#CS is active low)

  addr-size:
    type: int
    enum:
      - 0 # 24-bit mode
      - 1 # 32-bit mode
    default: 0
    description: |
      Address size to use in auto mode. In 24-bit mode up to 16MB can be
      accessed whilst in 32-bit mode up to 32MB can be accssed which is
      the max. address space supported by QSPICx.

  clock-div:
    type: int
    default: 0
    description: |
      Clock divider for QSPIC2 controller. The clock path of
      this block is always DIV1 which reflect the current
      system clock.

  tcem-max-us:
    type: int
    default: 2
    description: |
      If a non zero value is applied, then Tcem should be taken into
      consideration by QSPIC2 so that it can split a burst read/write
      access in case the total time exceeds the defined value
      (at the cost of extra cycles required for re-sending the instruction,
      address and dummy bytes, if any). This setting is meaningful only if
      is-ram is present. This value reflects the max. time in microsends the
      #CS line can be driven low in a write/read bust access (required for
      the auto-refresh mechanism, when supported).

  dummy-bytes-size:
    type: int
    default: 2
    enum:
      - 0 # 0 dummy bytes
      - 1 # 1 dummy byte
      - 2 # 2 dummy bytes
      - 3 # 4 dummy bytes
    description: |
      Number of dummy bytes to send for single/burst read access in auto mode.

  extra-byte-enable:
    type: boolean
    description: |
      If present the extra byte will be sent after the dummy bytes, if any.
      This should be useful if 3 dummy bytes are required. In such a case,
      dummy-bytes-size should be set to 2.

  extra-byte:
    type: int
    default: 0
    description: |
      Extra byte to be sent, if extra-byte-enable is present.

  rx-addr-mode:
    type: int
    default: 2
    enum:
      - 0 # Single SPI
      - 1 # Dual
      - 2 # Quad
    description: |
      Describes the mode of SPI bus during the address phase for single/burst
      read accesses in auto mode

  rx-inst-mode:
    type: int
    default: 0
    enum:
      - 0 # Single SPI
      - 1 # Dual
      - 2 # Quad
    description: |
      Describes the mode of SPI bus during the instruction phase for single/burst
      read accesses in auto mode.

  rx-data-mode:
    type: int
    default: 2
    enum:
      - 0 # Single SPI
      - 1 # Dual
      - 2 # Quad
    description: |
      Describes the mode of SPI bus during the data phase for single/burst
      read accesses in auto mode.

  rx-dummy-mode:
    type: int
    default: 2
    enum:
      - 0 # Single SPI
      - 1 # Dual
      - 2 # Quad
    description: |
      Describes the mode of SPI bus during the dummy bytes phase for single/burst
      read accesses in auto mode.

  rx-extra-mode:
    type: int
    default: 2
    enum:
      - 0 # Single SPI
      - 1 # Dual
      - 2 # Quad
    description: |
      Describes the mode of SPI bus during the extra byte phase for single/burst
      read accesses in auto mode.

  tx-addr-mode:
    type: int
    default: 2
    enum:
      - 0 # Single SPI
      - 1 # Dual
      - 2 # Quad
    description: |
      Describes the mode of SPI bus during the address phase for single/burst
      write accesses in auto mode.

  tx-inst-mode:
    type: int
    default: 0
    enum:
      - 0 # Single SPI
      - 1 # Dual
      - 2 # Quad
    description: |
      Describes the mode of SPI bus during the instruction phase for singe/burst
      write accesses in auto mode.

  tx-data-mode:
    type: int
    default: 2
    enum:
      - 0 # Single SPI
      - 1 # Dual
      - 2 # Quad
    description: |
      Describes the mode of SPI bus during the data phase for single/burst
      write accesses in auto mode.
